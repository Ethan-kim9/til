# 프록시?

1. 프록시(Proxy)
   1. 데이터가 실제 필요할 때 데이터를 불러오는, 지연로딩을 사용할 때 실제 엔티티 객체 대신 사용되는 가짜 객체

2. 프록시의 특징
   1. 실제 클래스를 상속 받아서 만들어진다.
   2. 실제 클래스와 겉 모양이 같다.
   3. 프록시 객체는 실제 객체의 참조(target)를 보관한다.
   4. 프록시 객체를 호출하면 프록시 객체는 실제 객체의 메서드를 호출
3. 프록시 진행방향(프록시 객체 초기화)
   1. Member -> Team 이 있을 때, Team 클래스를 부를 때까진 가짜 객체를 이용
   2. team 데이터를 직접 건드리면 데이터객체가 target 에 진짜 객체를 연결
   3. target 은 처음엔 null 임
4. 주의 사항
   1. 프록시 객체는 처음 사용할 때 한 번만 초기화됨
   2. 프록시 객체를 초기화 할 때, 프록시 객체가 실제 엔티티로 바뀌지 않음
   3. 초기화 되면 프록시 객체를 통해 실제 엔티티에 접근 가능
   4. 프록시 객체는 원본 엔티티를 상속받음 (타입체크시 주의해야함)
      1. == 비교가 아닌 instance of 를 사용해야함
   5. 영속성 컨텍스트에 찾는 엔티티가 이미 있으면, em.getReference() 를 호출해도 실제 엔티티 반환
      1. 프록시 호출하면 FIND 해도 프록시가 나온다.
   6. JPA 에서는 진짜 데이터 == 프록시 이다.
      1. 한 영속성 컨텍스트에서 가져오고 PK 가 같으면 항상 TRUE
   7. 영속성 컨텍스트의 도움을 받을 수 없는 준영속 상태일 때, 프록시를 초기화하면 문제 발생
      1. 영속성 컨텍스트를 날려버리면 DB 에서 데이터를 가져올 수 없기 때문
      2. 하이버네이트는 org.hibernate.LazyInitializationException 예외가 남